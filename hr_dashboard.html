<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HR Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>HR Panel</h2>
    <div class="user-info">
      <div class="user-avatar" id="sidebarAvatar" onclick="openProfileModal()">HR</div>
      <div class="user-name" id="sidebarName">HR Name</div>
      <div class="user-role" id="sidebarRole">Department</div>
    </div>
    <a class="active" onclick="showSection('hr-dashboard','.sidebar',event)">📊 Dashboard</a>
    <a onclick="showSection('hr-postjob','.sidebar',event)">📝 Post Job</a>
    <a onclick="showSection('hr-analytics','.sidebar',event)">📈 Analytics</a>
    <a onclick="showSection('hr-messages','.sidebar',event)">💬 Messages</a>
    <a onclick="showSection('hr-profile','.sidebar',event)">👤 Profile</a>
    <button class="logout-btn" onclick="logout()">🚪 Logout</button>
  </div>

  <!-- Main Content -->
  <div class="main">

    <!-- Dashboard -->
    <div id="hr-dashboard" class="section" style="display:block;">
      <h1>HR Dashboard Overview</h1>
      <div class="stats">
        <div class="card">
          <span class="card-number" id="totalJobs">-</span>
          <span class="card-label">Jobs Posted</span>
        </div>
        <div class="card">
          <span class="card-number" id="totalApplicants">-</span>
          <span class="card-label">Total Applicants</span>
        </div>
        <div class="card">
          <span class="card-number" id="avgMatch">-</span>
          <span class="card-label">Avg Match Score</span>
        </div>
        <div class="card">
          <span class="card-number" id="pendingReviews">-</span>
          <span class="card-label">Pending Reviews</span>
        </div>
      </div>
      <h2>Recent Job Applications</h2>
      <div id="jobApplications" class="job-applications"></div>
    </div>

    <!-- Post Job -->
    <div id="hr-postjob" class="section">
      <h1>Post New Job</h1>
      <form id="jobForm" class="form-card" onsubmit="postJob(event)">
        <div class="form-group">
          <label>Job Title *</label>
          <input type="text" name="title" required placeholder="e.g. Senior Software Developer">
        </div>
        <div class="form-group">
          <label>Job Description *</label>
          <textarea name="description" required rows="5" placeholder="Describe the role, responsibilities, and requirements..."></textarea>
        </div>
        <div class="form-group">
          <label>Location</label>
          <input type="text" name="location" placeholder="e.g. Bengaluru, Karnataka">
        </div>
        <div class="form-group">
          <label>Required Skills</label>
          <input type="text" name="skills" placeholder="e.g. JavaScript, React, Node.js">
        </div>
        <div class="form-group">
          <label>Employment Type</label>
          <select name="type" required>
            <option value="">Select Type</option>
            <option value="Full-time">Full-time</option>
            <option value="Part-time">Part-time</option>
            <option value="Contract">Contract</option>
            <option value="Internship">Internship</option>
          </select>
        </div>
        <div class="form-group">
          <label>Salary Range</label>
          <input type="text" name="salary" placeholder="e.g. ₹8-12 LPA">
        </div>
        <button type="submit" class="btn btn-primary">📝 Post Job</button>
      </form>
      <h2>My Posted Jobs</h2>
      <table class="styled-table">
        <thead>
          <tr>
            <th>Job Title</th>
            <th>Location</th>
            <th>Applicants</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="myJobsTable"></tbody>
      </table>
    </div>

    <!-- Analytics -->
    <div id="hr-analytics" class="section">
      <h1>Job Analytics & Reports</h1>
      <div class="chart-container">
        <h3>Applications by Job</h3>
        <canvas id="jobBarChart" width="400" height="200"></canvas>
      </div>
      <div class="stats" id="analyticsStats">
        <div class="card">
          <span class="card-number" id="mostPopularJob">-</span>
          <span class="card-label">Most Popular Job</span>
        </div>
        <div class="card">
          <span class="card-number" id="highestApplications">-</span>
          <span class="card-label">Highest Applications</span>
        </div>
        <div class="card">
          <span class="card-number" id="bestMatchRate">-</span>
          <span class="card-label">Best Match Rate</span>
        </div>
      </div>
      <div class="form-card">
        <h3>Export Data</h3>
        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
          <button class="btn btn-primary" onclick="exportCSV()">📊 Export Applicants CSV</button>
          <button class="btn btn-success" onclick="exportJobsCSV()">📋 Export Jobs CSV</button>
          <button class="btn btn-warning" onclick="generateReport()">📄 Generate Report</button>
        </div>
      </div>
    </div>

    <!-- Messages -->
    <div id="hr-messages" class="section">
      <h1>Messages</h1>
      <div class="chat-container">
        <div class="chat-header">💬 Team Communication</div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
          <input type="text" id="chatInput" placeholder="Type your message..." onkeypress="handleChatKeyPress(event)">
          <button class="btn btn-primary" onclick="sendChatMessage()">Send</button>
        </div>
      </div>
    </div>

    <!-- Profile -->
    <div id="hr-profile" class="section">
      <h1>My Profile</h1>
      <div class="form-card">
        <div class="avatar-upload">
          <div class="avatar-preview" id="profileAvatar" onclick="document.getElementById('avatarInput').click()">HR</div>
          <input type="file" id="avatarInput" accept="image/*" onchange="updateAvatar(event)" style="display: none;">
          <button class="upload-btn" onclick="document.getElementById('avatarInput').click()">Upload Photo</button>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label>Full Name</label>
            <input type="text" id="profileName" placeholder="Enter your full name">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="profileEmail" placeholder="Enter your email">
          </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label>Phone</label>
            <input type="tel" id="profilePhone" placeholder="Enter your phone number">
          </div>
          <div class="form-group">
            <label>Department</label>
            <input type="text" id="profileDepartment" placeholder="Enter your department">
          </div>
        </div>
        <div class="form-group">
          <label>Bio</label>
          <textarea id="profileBio" rows="4" placeholder="Tell us about yourself..."></textarea>
        </div>
        <div class="form-group">
          <label>Skills</label>
          <input type="text" id="profileSkills" placeholder="Enter your skills (comma separated)">
        </div>
        <div style="display: flex; gap: 15px; margin-top: 20px;">
          <button class="btn btn-primary" onclick="saveProfile()">💾 Save Profile</button>
          <button class="btn btn-success" onclick="previewProfile()">👁️ Preview Profile</button>
          <button class="btn btn-warning" onclick="changePassword()">🔐 Change Password</button>
        </div>
      </div>
      <!-- Skills Section -->
      <div class="form-card">
        <h3>🎯 Skills & Expertise</h3>
        <div id="skillsList" style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px;"></div>
        <div style="display: flex; gap: 10px;">
          <input type="text" id="newSkill" placeholder="Add a new skill">
          <button class="btn btn-primary" onclick="addSkill()">Add Skill</button>
        </div>
      </div>
      <!-- Experience Section -->
      <div class="form-card">
        <h3>💼 Experience & Projects</h3>
        <div id="experienceList"></div>
        <button class="btn btn-success" onclick="addExperience()">+ Add Experience</button>
      </div>
    </div>
  </div>

  <!-- Profile Modal -->
  <div id="profileModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Profile Settings</h2>
        <span class="close" onclick="closeProfileModal()">&times;</span>
      </div>
      <div class="avatar-upload">
        <div class="avatar-preview" id="modalAvatar" onclick="document.getElementById('modalAvatarInput').click()">HR</div>
        <input type="file" id="modalAvatarInput" accept="image/*" onchange="updateModalAvatar(event)">
        <button class="upload-btn" onclick="document.getElementById('modalAvatarInput').click()">Change Photo</button>
      </div>
      <div class="form-group">
        <label>Display Name</label>
        <input type="text" id="modalName" placeholder="Enter display name">
      </div>
      <div style="display: flex; gap: 15px; margin-top: 20px;">
        <button class="btn btn-primary" onclick="saveModalProfile()">Save</button>
        <button class="btn btn-danger" onclick="closeProfileModal()">Cancel</button>
      </div>
    </div>
  </div>

  <div id="notification-area" style="position:fixed;top:28px;right:28px;z-index:9999;"></div>

  <script src="frontend-api.js"></script>
  <script src="hr_dashboard.js"></script>
</body>
</html>